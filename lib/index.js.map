{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["/**\n * async load script\n */\n\nlet loadPromise = null;\n\nexport default class ApiLoader {\n  constructor(urlList = []) {\n    this.urlList = urlList.map(url => {\n      if (url.indexOf('http') > -1) {\n        return url;\n      } else {\n        return `${window.location.protocol}//${url}`;\n      }\n    });\n  }\n\n  scriptLoadPromise(url) {\n    const script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.async = true;\n    script.defer = true;\n    script.src = url;\n    const promise = new Promise(resolve => {\n      script.onload = () => {\n        resolve();\n      };\n    });\n    document.body.appendChild(script);\n    return promise;\n  }\n\n  buildChainPromise() {\n    return this.urlList.reduce((promise, url) => {\n      return promise.then(() => this.scriptLoadPromise(url));\n    }, Promise.resolve());\n  }\n\n  load() {\n    loadPromise = loadPromise || this.buildChainPromise();\n    return new Promise(resolve => {\n      loadPromise.then(() => {\n        resolve();\n      });\n    });\n  }\n}\n"],"names":["loadPromise","ApiLoader","urlList","map","url","indexOf","window","location","protocol","script","document","createElement","type","async","defer","src","promise","Promise","onload","resolve","body","appendChild","reduce","then","scriptLoadPromise","buildChainPromise"],"mappings":";;;;;;;;;;EAAA;;;;EAIA,IAAIA,cAAc,IAAlB;;MAEqBC;EACnB,uBAA0B;EAAA,QAAdC,OAAc,uEAAJ,EAAI;;EAAA;;EACxB,SAAKA,OAAL,GAAeA,QAAQC,GAAR,CAAY,eAAO;EAChC,UAAIC,IAAIC,OAAJ,CAAY,MAAZ,IAAsB,CAAC,CAA3B,EAA8B;EAC5B,eAAOD,GAAP;EACD,OAFD,MAEO;EACL,eAAUE,OAAOC,QAAP,CAAgBC,QAA1B,UAAuCJ,GAAvC;EACD;EACF,KANc,CAAf;EAOD;;;;wCAEiBA,KAAK;EACrB,UAAMK,SAASC,SAASC,aAAT,CAAuB,QAAvB,CAAf;EACAF,aAAOG,IAAP,GAAc,iBAAd;EACAH,aAAOI,KAAP,GAAe,IAAf;EACAJ,aAAOK,KAAP,GAAe,IAAf;EACAL,aAAOM,GAAP,GAAaX,GAAb;EACA,UAAMY,UAAU,IAAIC,OAAJ,CAAY,mBAAW;EACrCR,eAAOS,MAAP,GAAgB,YAAM;EACpBC;EACD,SAFD;EAGD,OAJe,CAAhB;EAKAT,eAASU,IAAT,CAAcC,WAAd,CAA0BZ,MAA1B;EACA,aAAOO,OAAP;EACD;;;0CAEmB;EAAA;;EAClB,aAAO,KAAKd,OAAL,CAAaoB,MAAb,CAAoB,UAACN,OAAD,EAAUZ,GAAV,EAAkB;EAC3C,eAAOY,QAAQO,IAAR,CAAa;EAAA,iBAAM,MAAKC,iBAAL,CAAuBpB,GAAvB,CAAN;EAAA,SAAb,CAAP;EACD,OAFM,EAEJa,QAAQE,OAAR,EAFI,CAAP;EAGD;;;6BAEM;EACLnB,oBAAcA,eAAe,KAAKyB,iBAAL,EAA7B;EACA,aAAO,IAAIR,OAAJ,CAAY,mBAAW;EAC5BjB,oBAAYuB,IAAZ,CAAiB,YAAM;EACrBJ;EACD,SAFD;EAGD,OAJM,CAAP;EAKD;;;;;;;;;;;;"}